<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13 - Challenge Calculator</title>
    <link rel="stylesheet" href="../../css/style.css">
    <style>
        div.calculator {
            background: url(images/calculadora/calc-ling.svg) no-repeat center;
            border-radius: 20px;
            transition: all 0.4s ease-in;
            height: 625px;
            width: 360px;
            header {
                position: relative;
                border-radius: 10px;
                width: 330px;
                height: 162px;
                margin: 0 auto;
                
                /* Nuevo contenedor de fondo para el área de display */
                .display-background {
                    position: absolute;
                    top: 45px;
                    width: 310px;
                    height: 90px;
                    background-color: rgba(255, 255, 200, 0.2); /* Amarillo claro para modo normal */
                    border-radius: 10px;
                    transition: all 0.4s ease-in;
                }
                
                button.btn-mode{
                    background: url(images/calculadora/btn-mode.svg);
                    cursor: pointer;
                    position: absolute;
                    top: 8px;
                    border-radius: 10px;
                    border: none;
                    height: 30px;
                    width: 120px;
                    transition: all 0.2s ease-in;
                }
            }
            input.oper {
                border: none;
                outline: none;
                display: flex;
                background-color: transparent;
                position: absolute;
                top: 65px;
                right: 10px;
                text-align: right;
                font-size: 18px;
                font-weight: 500;
                width: 310px;
                max-width: 310px;
                overflow: hidden;
            }
            h4.result {
                font-size: 36px;
                text-align: right;
                font-weight: 600;
                position: absolute;
                top: 90px;
                right: 10px;
                width: 310px;
                margin: 0;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
            
            h4.result.preview {
                color: #666;
                font-size: 28px;
            }
            
            h4.result.final {
                color: #000;
            }
            
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.05); }
                100% { transform: scale(1); }
            }
            
            footer{
                display: grid;
                grid-template-columns: repeat(4, 76px);
                width: 310px;
                gap: 5px;
                margin: 0.6rem auto 0 auto;
                button{
                    transition: all 0.4s ease-in;
                    cursor: pointer;
                    border: none;
                    height: 85px;
                    width: 90px;
                    position: relative;
                &.btn-clear{
                    background: url(images/calculadora/btn-clean.svg);
                }
                &.btn-del{
                    background: url(images/calculadora/btn-del.svg);
                }
                &.btn-pow{
                    background: url(images/calculadora/btn-pow.svg);
                }
                &.btn-mod{
                    background: url(images/calculadora/btn-mod.svg);
                }
                &.btn-one{
                    background: url(images/calculadora/btn-1.svg);
                }
                &.btn-two{
                    background: url(images/calculadora/btn-2.svg);
                }
                &.btn-three{
                    background: url(images/calculadora/btn-3.svg);
                }
                &.btn-multiply{
                    background: url(images/calculadora/btn-mul.svg);
                }
                &.btn-four{
                    background: url(images/calculadora/btn-4.svg);
                }
                &.btn-five{
                    background: url(images/calculadora/btn-5.svg);
                }
                &.btn-six{
                    background: url(images/calculadora/btn-6.svg);
                }
                &.btn-rest{
                    background: url(images/calculadora/btn-rest.svg);
                }
                &.btn-seven{
                    background: url(images/calculadora/btn-7.svg);
                }
                &.btn-eight{
                    background: url(images/calculadora/btn-8.svg);
                }
                &.btn-nine{
                    background: url(images/calculadora/btn-9.svg);
                }
                &.btn-sum{
                    background: url(images/calculadora/btn-sum.svg);
                }
                &.btn-div{
                    background: url(images/calculadora/btn-div.svg);
                }
                &.btn-zero{
                    background: url(images/calculadora/btn-0.svg);
                }
                &.btn-dote{
                    background: url(images/calculadora/btn-dote.svg);
                }
                &.btn-equal{
                    background: url(images/calculadora/btn-equal.svg);
                }
                }
            }
        }

        /*DARK MODE*/
        div.calculator.dark{
            background: url(images/calculadora/calculadora-dark.svg) no-repeat center;
            header {
                button.btn-mode{
                    background: url(images/calculadora/btn-mode-dark.svg);
                }
                
                /* Fondo gris claro para el modo oscuro */
                .display-background {
                    background-color: rgba(200, 200, 200, 0.2); /* Gris claro para modo oscuro */
                }
            }
            input.oper {
                color: #ffff;
            }
            h4.result{
                color: #ffff;
            }
            h4.result.preview {
                color: #ccc;
            }
            h4.result.final {
                color: #fff;
            }
            footer{
                button{
                    transition: all 0.4s ease-in;

                &.btn-clear{
                    background: url(images/calculadora/btn-clear-dark.svg);
                }
                &.btn-del{
                    background: url(images/calculadora/btn-del-dark.svg);
                }
                &.btn-pow{
                    background: url(images/calculadora/btn-pow-dark.svg);
                }
                &.btn-mod{
                    background: url(images/calculadora/btn-mod-dark.svg);
                }
                &.btn-one{
                    background: url(images/calculadora/btn-1-dark.svg);
                }
                &.btn-two{
                    background: url(images/calculadora/btn-2-dark.svg);
                }
                &.btn-three{
                    background: url(images/calculadora/btn-3-dark.svg);
                }
                &.btn-multiply{
                    background: url(images/calculadora/btn-mul-dark.svg);
                }
                &.btn-four{
                    background: url(images/calculadora/btn-4-dark.svg);
                }
                &.btn-five{
                    background: url(images/calculadora/btn-5-dark.svg);
                }
                &.btn-six{
                    background: url(images/calculadora/btn-6-dark.svg);
                }
                &.btn-rest{
                    background: url(images/calculadora/btn-rest-dark.svg);
                }
                &.btn-seven{
                    background: url(images/calculadora/btn-7-dark.svg);
                }
                &.btn-eight{
                    background: url(images/calculadora/btn-8-dark.svg);
                }
                &.btn-nine{
                    background: url(images/calculadora/btn-9-dark.svg);
                }
                &.btn-sum{
                    background: url(images/calculadora/btn-sum-dark.svg);
                }
                &.btn-div{
                    background: url(images/calculadora/btn-div-dark.svg);
                }
                &.btn-zero{
                    background: url(images/calculadora/btn-0-dark.svg);
                }
                &.btn-dote{
                    background: url(images/calculadora/btn-dote-dark.svg);
                }
                &.btn-equal{
                    background: url(images/calculadora/btn-equal-dark.svg);
                }
                }
            }
        }
    </style>
</head>
<body class="js">
    <nav>
        <a href="index.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="#ffffff" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
        </a>
    </nav>
    <main>
        <header>
            <h1>13 - Challenge Calculator</h1>
            <p>
                Build a basic calculator using JavaScript.
            </p>
        </header>
        <section>
            <div class="calculator">
                <header>
                    <div class="display-background"></div>
                    <button class="btn-mode"></button>
                    <input type="text" class="oper" readonly>
                    <h4 id="result-display" class="result"></h4>
                </header>
                <footer>
                    <button class="btn-clear"></button>
                    <button class="btn-del"></button>
                    <button class="btn-pow" data-opr="**"></button>
                    <button class="btn-mod" data-opr="%"></button>
                    <button class="btn-one" data-num="1"></button>
                    <button class="btn-two" data-num="2"></button>
                    <button class="btn-three" data-num="3"></button>
                    <button class="btn-multiply" data-opr="*"></button>
                    <button class="btn-four" data-num="4"></button>
                    <button class="btn-five" data-num="5"></button>
                    <button class="btn-six" data-num="6"></button>
                    <button class="btn-rest" data-opr="-"></button>
                    <button class="btn-seven" data-num="7"></button>
                    <button class="btn-eight" data-num="8"></button>
                    <button class="btn-nine" data-num="9"></button>
                    <button class="btn-sum" data-opr="+"></button>
                    <button class="btn-div" data-opr="/"></button>
                    <button class="btn-zero" data-num="0"></button>
                    <button class="btn-dote" data-opr="."></button>
                    <button class="btn-equal"></button>
                </footer>
            </div>
        </section>
    </main>
    <script>
        const operInput = document.querySelector('.oper');
        const resultDisplay = document.getElementById('result-display');
        const buttons = document.querySelectorAll('footer button');
    
        let currentOperation = '';
        const maxLength = 20;
    
        const updateDisplay = () => {
            operInput.value = currentOperation;
            try {
                const result = eval(currentOperation);
                if (result !== undefined && isFinite(result)) {
                    resultDisplay.textContent = result;
                } else {
                    resultDisplay.textContent = '';
                }
            } catch {
                resultDisplay.textContent = '';
            }
        };
    
        const isOperator = char => ['+', '-', '*', '/', '%', '**', '.'].includes(char);
    
        buttons.forEach(button => {
            const num = button.dataset.num;
            const opr = button.dataset.opr;
    
            // Botón de número
            if (num !== undefined) {
                button.addEventListener('click', () => {
                    if (currentOperation.length < maxLength) {
                        currentOperation += num;
                        updateDisplay();
                    }
                });
            }
    
            // Botón de operador
            if (opr !== undefined) {
                button.addEventListener('click', () => {
                    if (currentOperation.length === 0 && opr !== '-') return; // No empieces con operadores excepto "-"
                    
                    const lastChar = currentOperation.slice(-1);
    
                    if (isOperator(lastChar)) {
                        currentOperation = currentOperation.slice(0, -1) + opr; // Reemplaza el último operador
                    } else if (currentOperation.length < maxLength) {
                        currentOperation += opr;
                    }
    
                    updateDisplay();
                });
            }
    
            // Botón igual
            if (button.classList.contains('btn-equal')) {
                button.addEventListener('click', () => {
                    try {
                        currentOperation = eval(currentOperation).toString();
                        updateDisplay();
                    } catch (e) {
                        resultDisplay.textContent = 'Error';
                    }
                });
            }
    
            // Botón borrar (DEL)
            if (button.classList.contains('btn-del')) {
                button.addEventListener('click', () => {
                    currentOperation = currentOperation.slice(0, -1);
                    updateDisplay();
                });
            }
    
            // Botón limpiar (C)
            if (button.classList.contains('btn-clear')) {
                button.addEventListener('click', () => {
                    currentOperation = '';
                    resultDisplay.textContent = '';
                    operInput.value = '';
                });
            }
        });
    
        // Modo oscuro
        document.querySelector('.btn-mode').addEventListener('click', () => {
            document.querySelector('.calculator').classList.toggle('dark');
        });
    </script>       
</body>
</html>